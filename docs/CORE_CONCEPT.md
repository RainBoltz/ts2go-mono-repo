# TypeScript to Go è½‰è­¯å™¨æ ¸å¿ƒæ¦‚å¿µ

> Core Concepts and Development Plan for TS2Go Transpiler

è¦æŠŠ TypeScript è‡ªå‹•è½‰æˆ Goï¼Œè€Œä¸”é‚„è¦æ¯”ç¾æœ‰å·¥å…·æ›´ç©©â€”â€”é—œéµæ˜¯**æŠŠèªç¾©ä¿çœŸ**ç•¶ç¬¬ä¸€å„ªå…ˆã€‚
é€™æ˜¯ä¸€ä»½å¯è½åœ°çš„é–‹ç™¼è·¯ç·šåœ–ï¼ˆåˆ†éšæ®µï¼‰ï¼Œæ¶µè“‹æ¶æ§‹ã€å‹åˆ¥å°æ‡‰ã€èªç¾©é™·é˜±ã€æ¸¬è©¦èˆ‡å“è³ªç­–ç•¥ï¼Œä»¥åŠè¿­ä»£ç¯€é»ã€‚

**ç‹€æ…‹æ›´æ–°**ï¼šæœ¬æ–‡ä»¶åŸç‚ºé–‹ç™¼è¨ˆç•«ï¼Œç›®å‰å¤§éƒ¨åˆ†åŠŸèƒ½å·²å¯¦ä½œå®Œæˆã€‚è«‹åƒè€ƒ ARCHITECTURE.md ä»¥äº†è§£ç›®å‰çš„å¯¦ä½œç‹€æ…‹ã€‚

# ç¬¬ 0 éšæ®µï¼šç•Œå®šç¯„åœ

* **æ”¯æ´ç›®æ¨™**ï¼šç´” TSï¼ˆé TSXï¼‰ã€ES æ¨¡çµ„ã€å¸¸è¦‹èªè¨€ç‰¹æ€§ï¼ˆæ³›å‹ã€ä»‹é¢ã€union/intersectionã€async/awaitã€ä¾‹å¤–è™•ç†ã€enumã€namespaceï¼‰ã€‚
* **ä¸æ”¯æ´ / å»¶å¾Œ**ï¼šDOM/Browser APIã€åå°„/Proxyã€evalã€è£é£¾å™¨ decoratorsï¼ˆå…ˆä»¥è¨»è§£ä¿ç•™ï¼‰ã€å‹•æ…‹ importã€JSX/Reactã€‚
* **è¼¸å‡ºç›®æ¨™**ï¼šGo 1.22+ï¼ˆå«æ³›å‹ï¼‰ï¼Œå–®æ¨¡çµ„è¼¸å‡ºï¼ˆgo.modï¼‰ï¼Œæ¨™æº– `go fmt` è¼¸å‡ºï¼Œé›¶ç¬¬ä¸‰æ–¹ runtimeï¼ˆé™¤éå¿…è¦çš„å°å‹è¼”åŠ©åº«ï¼‰ã€‚
* **æˆåŠŸæ¨™æº–**ï¼š

  1. è½‰å‡ºç¨‹å¼èƒ½ `go build` + `go vet` é€šéï¼›
  2. å–®æ¸¬å°é½Šï¼ˆè¦‹å¾Œè¿°å·®åˆ†æ¸¬è©¦ï¼‰ï¼›
  3. éŒ¯èª¤è¨Šæ¯å¯å®šä½åˆ°åŸå§‹ TS è¡Œåˆ—è™Ÿã€‚

# ç¬¬ 1 éšæ®µï¼šç³»çµ±æ¶æ§‹èˆ‡ IR âœ… **å·²å®Œæˆ**

**ç¸½é«”æ¶æ§‹**

1. **å‰ç«¯ï¼ˆTS å‰ç«¯ï¼‰** âœ… `src/frontend/parser.ts`

   * ä½¿ç”¨ TypeScript å®˜æ–¹ Compiler API å»º AST + é¡å‹è³‡è¨Šï¼ˆå¿…ç”¨ TS type checkerï¼Œä¸é å­—ä¸²è§£æï¼‰ã€‚
   * ç”¢ç”Ÿä½ çš„ **èªç¾© IR**ï¼ˆä¸­ä»‹è¡¨ç¤ºï¼‰è€Œéç›´æ¥å Goï¼šIR è¦å®¹ç´ TS å‹åˆ¥ç³»çµ±çš„è³‡è¨Šï¼ˆæ³›å‹ã€unionã€narrowingã€å¯ç©ºæ€§ã€modifiersï¼‰ã€‚

2. **ä¸­ç«¯ï¼ˆIR Passesï¼‰** âœ… `src/ir/transformer.ts`, `src/optimizer/optimizer.ts`

   * æ­£è¦åŒ–æ§åˆ¶æµç¨‹ï¼ˆå°‡ `try/catch/finally`ã€çŸ­è·¯ã€optional chaining ç­‰ï¼Œå±•é–‹ç‚ºé¡¯å¼ CFGï¼‰ã€‚
   * å‹åˆ¥æŠ¹å¹³ï¼šæŠŠ TS çš„çµæ§‹åŒ–å‹åˆ¥èˆ‡ union/intersectionï¼Œè½‰ç‚ºå¯æ˜ å°„åˆ° Go çš„å‹åˆ¥æ§‹é€ ï¼ˆè©³è¦‹ä¸‹ä¸€ç¯€ï¼‰ã€‚
   * èªæ„é™éšï¼šå°‡ `async/await`ã€Promiseã€ä¾‹å¤–è½‰ç‚º Go æ…£ç”¨èªç¾©ã€‚

3. **å¾Œç«¯ï¼ˆGo ç”¢ç”Ÿå™¨ï¼‰** âœ… `src/backend/go-generator.ts`

   * **å¯¦ä½œç´°ç¯€**ï¼šç›´æ¥ç”¢ç”Ÿ Go ç¨‹å¼ç¢¼å­—ä¸²ï¼ˆä½¿ç”¨ Visitor æ¨¡å¼ï¼‰ï¼Œç¢ºä¿ `go fmt` ç›¸å®¹çš„è¼¸å‡ºã€‚
   * ç”¢å‡ºå¤šæª”æ¡ˆï¼ˆä»¥æ¨¡çµ„/namespace å°æ‡‰ packageï¼‰ï¼Œè‡ªå‹•å»ºç«‹ `go.mod`ã€‚
   * **æ³¨æ„**ï¼šç›®å‰ä¸ä½¿ç”¨ `go/ast` + `go/printer`ï¼ˆé€™äº›æ˜¯ Go å¥—ä»¶ï¼‰ï¼Œè€Œæ˜¯åœ¨ TypeScript ä¸­ç›´æ¥ç”Ÿæˆæ ¼å¼åŒ–çš„ Go ç¨‹å¼ç¢¼ã€‚

4. **æœ€å° runtimeï¼ˆå¯é¸ï¼‰** âœ… `src/runtime/`

   * Runtime helpers å®šç¾©åœ¨ `helpers.go.template`
   * æä¾› Optional chainingã€Union typesã€Promise/Futureã€Array helpers ç­‰è¼”åŠ©å‡½å¼
   * å¯é€éé…ç½®é¸æ“‡æ€§ç”¢ç”Ÿæ‰€éœ€çš„ runtime åŠŸèƒ½
   * RuntimeGenerator (`src/runtime/runtime-generator.ts`) è² è²¬ç”¢ç”Ÿå®¢è£½åŒ–çš„ runtime ç¨‹å¼ç¢¼

# ç¬¬ 2 éšæ®µï¼šå‹åˆ¥èˆ‡èªç¾©å°æ˜ è¨­è¨ˆï¼ˆé—œéµï¼‰

**æ¨™æº–å‹åˆ¥å°æ˜ **

* `number` â†’ `float64`ï¼ˆæˆ–ä¾ä¸Šä¸‹æ–‡çª„åŒ–æˆ `int`/`int64`ï¼›å‹™å¿…å¯è¨­å®šç­–ç•¥ï¼‰ã€‚
* `string` â†’ `string`ï¼›`boolean` â†’ `bool`ã€‚
* `any` â†’ `any`ï¼ˆGo ç„¡æ­¤å‹ï¼Œå¯ç”¨ `any`/`interface{}`ï¼‰ï¼Œæ­é…åš´æ ¼æ¨¡å¼æä¾› `//go:check` runtime æ–·è¨€ã€‚
* `unknown` â†’ `any` ä½†ç”Ÿæˆè™•å¼·åˆ¶å‹åˆ¥æª¢æŸ¥ï¼ˆIR æ’å…¥ assert/ok idiomï¼‰ã€‚
* `Array<T>` â†’ `[]T`ï¼›`Record<K,V>`/ç´¢å¼•ç°½ç«  â†’ `map[string]V`ï¼ˆK å¸¸è½åœ¨ stringï¼‰ã€‚
* `enum` â†’ `iota` + é¡¯å¼åº•å±¤å‹åˆ¥ï¼ˆ`int`ï¼‰ï¼Œä¸¦ç”Ÿæˆ `String()`ï¼ˆfmt å‹å¥½ï¼‰ã€‚
* Tuple `[A,B]` â†’ è‡ªå‹•ç”Ÿæˆ `struct{ A A; B B }`ï¼ˆå…·åæ¬„ä½ï¼‰ï¼Œæˆ– `type Tuple2[A,B] struct{ First A; Second B }`ã€‚
* `interface`ï¼ˆTS çµæ§‹å‹ï¼‰â†’ **Go struct + å°æ‡‰ä»‹é¢**

  * ç”Ÿæˆæœ€å°ä»‹é¢ï¼ˆmethod setï¼‰+ å¯¦ä½œçš„ structï¼›
  * å¯é¸ã€Œé´¨å­å‹åˆ¥æ¨¡å¼ã€ï¼šç‚ºå­˜å–é»è‡ªå‹•ç”ŸæˆåŒ¿åä»‹é¢ä»¥å…¼å®¹çµæ§‹åŒ–ç›¸å®¹æ€§ã€‚
* `class` â†’ `struct` + æŒ‡æ¨™æ–¹æ³•ï¼›`extends` â†’ å…§åµŒæˆ–çµ„åˆï¼ˆå»ºè­°å…§åµŒï¼šç¬¦åˆ Go idiomï¼‰ã€‚
* æ³›å‹ `T` â†’ Go type parameterï¼ˆ1.18+ï¼‰ï¼Œconstraints ç”± TS `extends` æ¨å°æˆ Go `~` æˆ–ä»‹é¢é›†åˆã€‚
* Union `A | B` â†’ å¹¾ç¨®ç­–ç•¥ï¼ˆå¯é…ç½®ï¼‰ï¼š

  1. **Tagged Union**ï¼šç”Ÿæˆ `struct{ tag int; a *A; b *B }` + helpersï¼›
  2. **æ¥å£åˆ†æ´¾**ï¼šæŠ½è±¡æˆ `interface{ isU() }`ï¼ŒA/B å¯¦ä½œ markerï¼›
  3. **any + å‹åˆ¥å®ˆè¡›**ï¼šæœ€å°‘ä¾µå…¥ï¼Œä½†è¼ƒä¸å®‰å…¨ã€‚
     ä»¥å¯é æ¸¬èˆ‡æ˜“é™¤éŒ¯ç‚ºé¦–é¸ï¼ˆå¤šç”¨ 1 æˆ– 2ï¼‰ã€‚
* Intersection `A & B` â†’ ç”Ÿæˆåˆä½µ structï¼›è¡çªæ¬„ä½å ±éŒ¯æˆ–ç”Ÿæˆå‰ç¶´ã€‚
* `readonly`ã€å¯é¸å±¬æ€§ `?` â†’ ä»¥æŒ‡æ¨™æˆ– `,omitempty` æ¨™è¨»ã€æˆ–åœ¨å»ºæ§‹å™¨æ³¨å…¥ defensive copyã€‚
* `null | undefined` â†’ `*T`ï¼ˆæŒ‡æ¨™ï¼‰æˆ– `sql.Null*` ç­‰é¡¯å¼ Nullable å‹åˆ¥ï¼ˆå¯é…ç½®ï¼‰ã€‚

**èªç¾©å°æ˜ èˆ‡èªæ³•ç³–**

* **ä¾‹å¤– â†’ éŒ¯èª¤è¿”å›**ï¼š

  * `throw` â†’ å›å‚³ `error`ï¼›
  * `try/catch` â†’ ç”¢ç”Ÿ `val, err := fn(...); if err != nil { ... }`ï¼›
  * `finally` â†’ `defer`ã€‚
  * å¯æä¾›ã€Œåš´æ ¼ panic æ¨¡å¼ã€åšåŸå‹é©—è­‰ï¼Œä½†é è¨­èµ° `error`ã€‚
* **async/await/Promise**ï¼ˆä¸‰é¸ä¸€ï¼Œå¯é…ç½®ï¼Œå»ºè­°å…ˆé¸ Aï¼‰ï¼š
  A) **åŒæ­¥é™éš**ï¼šè‹¥ await éˆä¸­ç„¡çœŸæ­£ I/Oï¼Œç›´æ¥å±•é–‹ç‚ºåŒæ­¥å‘¼å«ï¼ˆæœ€å¿«è½åœ°ï¼‰ã€‚
  B) **Channel/Future**ï¼š`type Future[T] struct{ ch chan result[T] }`ï¼›`await`â†’ `<-ch`ã€‚
  C) **goroutine + errgroup**ï¼šå°ä¸¦è¡Œæ®µè½ç”¢ç”Ÿ `errgroup` æ¨¡å¼ã€‚
* **optional chaining / nullish coalescing**ï¼š

  * ç”¢ç”Ÿå®‰å…¨å­˜å–ç¨‹å¼ç¢¼æˆ–å‘¼å« `rt.GetOrDefault(...)`ã€‚
* **è¿­ä»£å™¨ / for..of**ï¼šè½‰ `for range`ï¼ˆå¿…è¦æ™‚ç”Ÿæˆ adapterï¼‰ã€‚
* **ç‰©ä»¶å­—é¢é‡ / å±•é–‹é‹ç®—å­**ï¼šå»ºç«‹ struct ç´¯åŠ å™¨ï¼›æ“´å±•ä»¥æ·ºæ‹·è²è™•ç†ã€‚
* **éœæ…‹å±¬æ€§/æ–¹æ³•**ï¼šå°æ‡‰ package-level è®Šæ•¸/å‡½å¼ã€‚
* **æ¨¡çµ„ç³»çµ±**ï¼šESM `import/export` â†’ Go `package` + æª”æ¡ˆåˆ†å‰²ï¼›`default export` â†’ å°æ‡‰å…¬æœ‰å `Default` æˆ–æª”æ¡ˆç´šå°å‡ºè¡¨ã€‚

# ç¬¬ 3 éšæ®µï¼šæœ€å°å¯ç”¨ç‰ˆæœ¬ï¼ˆMVPï¼‰âœ… **å·²å®Œæˆ**

* âœ… **æ”¯æ´**ï¼šåŸºæœ¬å‹åˆ¥ã€å‡½å¼ã€struct/classã€ä»‹é¢ã€æ³›å‹ã€é™£åˆ—/Mapã€éŒ¯èª¤è¿”å›ã€åŒæ­¥é‚è¼¯ã€‚
* âœ… **å·²å¯¦ä½œ**ï¼šunion/intersection åŸºç¤æ”¯æ´ã€async/await è½‰æ›
* âœ… **äº¤ä»˜**ï¼šCLIï¼ˆ`ts2go`ï¼‰ï¼Œè¼¸å…¥å°ˆæ¡ˆè·¯å¾‘ï¼Œè¼¸å‡º Go æ¨¡çµ„ï¼Œå« runtime helpersï¼ˆå¦‚éœ€ï¼‰ã€‚
  - CLI ä½æ–¼ `src/cli.ts`
  - æ”¯æ´ compileã€watchã€initã€infoã€runtime å‘½ä»¤
  - é…ç½®æª”æ¡ˆ `ts2go.json` æ”¯æ´

# ç¬¬ 4 éšæ®µï¼šé«˜ç´šå‹åˆ¥èˆ‡èªæ„è£œé½Š ğŸš§ **éƒ¨åˆ†å®Œæˆ**

* âœ… **Union/Intersection åŸºç¤æ”¯æ´**ï¼šTagged unionã€Interface unionã€Any ä¸‰ç¨®ç­–ç•¥
* ğŸš§ **Mapped/Conditional Types**ï¼ˆé€²è¡Œä¸­ï¼‰ï¼šå°‡å¸¸ç”¨å·¥å…·å‹åˆ¥ï¼ˆ`Partial`, `Pick`, `Omit`, `Record`ï¼‰é™éšç‚ºç”Ÿæˆå™¨æ¨¡æ¿ã€‚
* ğŸš§ **Overload è§£æ**ï¼ˆè¦åŠƒä¸­ï¼‰ï¼šæ ¹æ“š callsite æ¨æ–·æ­£ç¢ºçš„ Go å‡½å¼ç°½åï¼ˆå¿…è¦æ™‚ç”¢ç”Ÿå¤šå€‹ wrapperï¼‰ã€‚
* âœ… **æ³›å‹æ¨å°**ï¼šåŸºæœ¬çš„æ³›å‹æ¨å°å·²æ”¯æ´ï¼Œå°æ‡‰ Go çš„å‹åˆ¥åƒæ•¸
* ğŸ“‹ **æ¨¡çµ„ç›¸ä¾è™•ç†**ï¼ˆæœªä¾†è¨ˆåŠƒï¼‰ï¼šå° NPM å¥—ä»¶æä¾›ã€Œå°æ˜ å±¤ã€ï¼š
  * ç´”å‹åˆ¥å¥—ä»¶ â†’ å¿½ç•¥æˆ–è½‰ç©ºæ®¼ï¼›
  * åŸ·è¡ŒæœŸå¥—ä»¶ â†’ æä¾› Go ç­‰æ•ˆï¼ˆç™½åå–®æ¸…å–®ï¼‰ï¼›å…¶ä»–ç›´æ¥å ±ä¸æ”¯æ´ã€‚

# ç¬¬ 5 éšæ®µï¼šæ¸¬è©¦èˆ‡å“è³ªä¿è­‰ âœ… **å·²å®Œæˆ**

**å·®åˆ†èˆ‡é»ƒé‡‘æ¸¬è©¦**

* âœ… **é»ƒé‡‘æ¸¬è©¦ï¼ˆgolden testsï¼‰** - `tests/golden/`
  - å·²å¯¦ä½œ 10 å€‹ç¶œåˆæ¸¬è©¦æ¡ˆä¾‹ï¼Œæ¶µè“‹æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½
  - `GoldenTestRunner` (`tests/helpers/golden-test.ts`) è² è²¬åŸ·è¡Œèˆ‡æ¯”å°
  - å›ºå®šè¼¸å‡ºæª”æ¡ˆå¿«ç…§ï¼Œç¢ºä¿è¼¸å‡ºä¸€è‡´æ€§
  - æ”¯æ´ `updateExpected()` æ–¹æ³•æ›´æ–°é æœŸè¼¸å‡º

* âœ… **å·®åˆ†æ¸¬è©¦ï¼ˆdifferential testingï¼‰** - `tests/helpers/diff-tool.ts`
  - `DifferentialTestRunner` æ¯”è¼ƒä¸åŒç·¨è­¯ç­–ç•¥çš„è¼¸å‡º
  - é å®šç¾©ç­–ç•¥ï¼šdefault, int_numbers, interface_unions, zero_nullability, strict
  - å¯åˆ†æä¸åŒç­–ç•¥é–“çš„å·®ç•°

* âœ… **Jest æ¸¬è©¦æ¡†æ¶** - `jest.config.js`, `tests/setup.ts`
  - è‡ªè¨‚ matchers: `toMatchGoCode()`, `toBeValidGo()`
  - å®Œæ•´çš„æ¸¬è©¦è¦†è“‹ç‡å ±å‘Š
  - 30 ç§’æ¸¬è©¦è¶…æ™‚è¨­å®š

* ğŸ“‹ **æ¨¡ç³Š/å±¬æ€§æ¸¬è©¦**ï¼ˆæœªä¾†è¨ˆåŠƒï¼‰ï¼šå°èªæ³•æ§‹é€ é€²è¡Œéš¨æ©Ÿçµ„åˆï¼ˆquickcheckï¼‰ï¼Œé©—è­‰ä¸ crashã€ç”¢ç”Ÿç¢¼å¯ç·¨è­¯ã€‚
* ğŸ“‹ **Fuzz Testing**ï¼ˆæœªä¾†è¨ˆåŠƒï¼‰ï¼šGo å…§å»º fuzzï¼ˆ1.18+ï¼‰è·‘åœ¨è¼¸å‡º API ä¸Šã€‚
* ğŸ“‹ **æ•ˆèƒ½å°æ¯”**ï¼ˆæœªä¾†è¨ˆåŠƒï¼‰ï¼šé‡å°ç†±è·¯å¾‘ï¼ˆè¿­ä»£ã€æ•¸å€¼ã€JSON è™•ç†ï¼‰åŸºæº–æ¸¬è©¦ï¼Œç¢ºä¿ç„¡ä¸å¿…è¦ allocã€‚

# ç¬¬ 6 æ­¥ï¼šé–‹ç™¼è€…é«”é©—ï¼ˆDXï¼‰âœ… **å·²å®Œæˆ**

* âœ… **éŒ¯èª¤ä½ç½®è¿½è¹¤**ï¼ˆ`src/ir/location.ts`ï¼‰ï¼š
  - æ¯å€‹ IR ç¯€é»åŒ…å« `SourceLocation`
  - éŒ¯èª¤è¨Šæ¯å¯ç²¾ç¢ºå®šä½åˆ°åŸå§‹ TypeScript æª”æ¡ˆçš„è¡Œåˆ—è™Ÿ
  - æ”¯æ´éŒ¯èª¤å ±å‘Šèˆ‡å †ç–Šè¿½è¹¤

* âœ… **Source Map ç”¢ç”Ÿ**ï¼ˆ`src/backend/sourcemap.ts`ï¼‰ï¼š
  - æ”¯æ´ source map ç”¢ç”Ÿ
  - å¯è¿½è¹¤ Go ç¨‹å¼ç¢¼å°æ‡‰çš„åŸå§‹ TypeScript ä½ç½®

* âœ… **å¯æ§è®Šæ›ç­–ç•¥**ï¼ˆ`ts2go.json`ï¼‰- `src/config/options.ts`ï¼š
  - `numberStrategy: float64|int|contextual`
  - `unionStrategy: tagged|interface|any`
  - `asyncStrategy: sync|future|errgroup`
  - `nullabilityStrategy: pointer|zero|sqlNull`
  - `errorHandling: return|panic`
  - `optimizationLevel: 0|1|2`

* âœ… **CLI å·¥å…·**ï¼ˆ`src/cli.ts`ï¼‰ï¼š
  - å½©è‰²è¼¸å‡ºï¼ˆä½¿ç”¨ chalkï¼‰
  - è©³ç´°æ—¥èªŒæ¨¡å¼
  - Watch æ¨¡å¼ï¼ˆä½¿ç”¨ chokidarï¼‰
  - åˆå§‹åŒ–é…ç½®æª”ï¼ˆ`ts2go init`ï¼‰

* ğŸ“‹ **å…§åµŒè¦å‰‡è¨»è§£**ï¼ˆæœªä¾†è¨ˆåŠƒï¼‰ï¼šå…è¨±åœ¨ TS åŠ è¨»å¦‚ `// @ts2go:skip`, `// @ts2go:rename FooBar`ã€‚

# èªç¾©é™·é˜±æ¸…å–®ï¼ˆä¸€é–‹å§‹å°±è¦é˜²ï¼‰

* **çµæ§‹å‹ vs åç¨±å‹**ï¼šTS æ˜¯çµæ§‹å‹ï¼ŒGo ä»‹é¢å…·å + method setï¼›éœ€è¦åœ¨ callsite ç”¢ç”Ÿ adapterã€‚
* **ä¾‹å¤–èªç¾©**ï¼šTS ä»»ä½•æ±è¥¿éƒ½èƒ½ `throw`ï¼›Go åš´æ ¼ `error`ã€‚å°é `error` å‹æ…‹éœ€åŒ…è£ã€‚
* **æµ®é»èˆ‡æ•´æ•¸**ï¼š`number` æ··ç”¨å¯èƒ½å¼•å…¥ truncationï¼›å‹™å¿…åœ¨ç®—è¡“é»æ’å…¥é¡¯å¼è½‰å‹ã€‚
* **å¯é¸å±¬æ€§**ï¼šTS çš„ `obj?.x` èˆ‡ `in`/`hasOwnProperty` å°æ‡‰è¦ç²¾ç¢ºï¼›Go é›¶å€¼ä¸ç­‰æ–¼ã€Œç¼ºå¸­ã€ï¼Œå¤šç”¨æŒ‡æ¨™æˆ– `ok` pairã€‚
* **this ç¶å®š**ï¼šclass method èˆ‡è‡ªç”±å‡½å¼çš„ `this` å·®ç•°ï¼›Go æ–¹æ³•æ¥æ”¶è€…è¨­è¨ˆè¦ä¸€è‡´ã€‚
* **æ¨¡çµ„å‰¯ä½œç”¨**ï¼šESM é †åºèˆ‡å‰¯ä½œç”¨åˆå§‹åŒ–ï¼›Go çš„ `init()` å¯èƒ½è¦ç”Ÿæˆä¸”æ§åˆ¶é †åºã€‚
* **ä½å…ƒæ“ä½œ**ï¼šTS number æ˜¯ 64-bit floatï¼›ä½é‹ç®—ä»¥ 32-bit æ•´æ•¸èªç¾©é€²è¡Œï¼Œéœ€å°å¿ƒ castã€‚

# é‡Œç¨‹ç¢‘èˆ‡æª¢æ ¸

1. âœ… **M1**ï¼šèƒ½è½‰è­¯ 100+ å€‹èªæ³•æ¨£ä¾‹ï¼Œå…¨æ•¸ `go build`ã€‚
   - **ç‹€æ…‹**ï¼šå·²å®Œæˆã€‚10 å€‹ç¶œåˆé»ƒé‡‘æ¸¬è©¦æ¶µè“‹æ ¸å¿ƒèªæ³•
   - **ä½ç½®**ï¼š`tests/golden/`

2. âœ… **M2**ï¼šæ”¯æ´ union/optional/async çš„ 80% å ´æ™¯ã€‚
   - **ç‹€æ…‹**ï¼šå·²å®Œæˆã€‚Unionï¼ˆ3ç¨®ç­–ç•¥ï¼‰ã€Optionalã€Async/Await åŸºç¤æ”¯æ´å®Œæˆ
   - **å¯¦ä½œ**ï¼š`src/backend/type-mapper.ts`, `src/backend/go-generator.ts`

3. ğŸš§ **M3**ï¼šè·‘é€šä¸€å€‹ä¸­å°å‹é–‹æº TS å°ˆæ¡ˆï¼ˆä¸ä¾è³´ DOMï¼‰ï¼Œç”¢ç”Ÿå¯åŸ·è¡Œ CLIï¼ˆè¡Œç‚ºå°é½Š 80%+ï¼‰ã€‚
   - **ç‹€æ…‹**ï¼šé€²è¡Œä¸­ã€‚CLI å·¥å…·å·²å®Œæˆï¼Œéœ€è¦å¯¦éš›å°ˆæ¡ˆæ¸¬è©¦

4. ğŸ“‹ **M4**ï¼šåŠ å…¥å°æ˜ å±¤ï¼ˆå¸¸è¦‹å·¥å…·å‡½å¼ã€è³‡æ–™çµæ§‹ï¼‰ï¼Œç©©å®šæ€§>90%ï¼ˆbuild+æ¸¬è©¦é€šéç‡ï¼‰ã€‚
   - **ç‹€æ…‹**ï¼šæœªä¾†è¨ˆåŠƒã€‚NPM å¥—ä»¶å°æ˜ å±¤

# æœ€å°ç¯„ä¾‹ï¼ˆå°æ˜ ç¤ºæ„ï¼‰

**TS**

```ts
export interface User { id: string; name?: string }
export type Result = { ok: true; value: number } | { ok: false; error: Error }

export async function getUser(id: string): Promise<User> {
  if (!id) throw new Error("bad id");
  return { id, name: "Ada" };
}

export function add(a: number, b: number | undefined) {
  return a + (b ?? 0);
}
```

**ç”¢ç”Ÿçš„ Goï¼ˆæ¦‚å¿µç¤ºæ„ï¼‰**

```go
package mod

type User struct {
    Id   string
    Name *string
}

type Result interface {
    isResult()
}
type okResult struct{ Value float64 }
func (okResult) isResult() {}
type errResult struct{ Error error }
func (errResult) isResult() {}

func GetUser(ctx context.Context, id string) (User, error) {
    if id == "" { return User{}, fmt.Errorf("bad id") }
    name := "Ada"
    return User{Id: id, Name: &name}, nil
}

func Add(a float64, b *float64) float64 {
    var z float64
    if b != nil { z = *b }
    return a + z
}
```

# å°ˆæ¡ˆç‹€æ…‹ç¸½çµ

## âœ… å·²å®Œæˆçš„æ ¸å¿ƒåŠŸèƒ½
- **å®Œæ•´çš„ IR ç³»çµ±**ï¼š40+ ç¯€é»é¡å‹ï¼Œå®Œæ•´çš„ Visitor æ¨¡å¼
- **TypeScript è§£æ**ï¼šä½¿ç”¨å®˜æ–¹ Compiler APIï¼Œå®Œæ•´å‹åˆ¥æª¢æŸ¥
- **Go ç¨‹å¼ç¢¼ç”¢ç”Ÿ**ï¼šç›´æ¥ç”¢ç”Ÿæ ¼å¼åŒ–çš„ Go ç¨‹å¼ç¢¼
- **å‹åˆ¥å°æ˜ **ï¼šå¤šç­–ç•¥æ”¯æ´ï¼ˆunion, number, nullability, asyncï¼‰
- **å„ªåŒ–ç³»çµ±**ï¼šæ­»ç¢¼æ¶ˆé™¤ã€å¸¸æ•¸æŠ˜ç–Šç­‰
- **æ¸¬è©¦æ¡†æ¶**ï¼š10 å€‹é»ƒé‡‘æ¸¬è©¦ + å·®åˆ†æ¸¬è©¦å·¥å…·
- **CLI å·¥å…·**ï¼šå®Œæ•´åŠŸèƒ½ï¼ˆcompile, watch, init ç­‰ï¼‰
- **Runtime Helpers**ï¼šOptional, Union, Future, Array helpers

## ğŸš§ é€²è¡Œä¸­çš„åŠŸèƒ½
- Mapped/Conditional Types å®Œæ•´æ”¯æ´
- æ›´ç²¾ç¢ºçš„å‹åˆ¥æ¨æ–·
- æ¨¡çµ„ç›¸ä¾æ€§è§£æ

## ğŸ“‹ æœªä¾†è¨ˆåŠƒ
- å¢é‡ç·¨è­¯
- VS Code æ“´å……
- NPM å¥—ä»¶å°æ˜ åº«
- æ•ˆèƒ½åŸºæº–æ¸¬è©¦
- ç¤¾ç¾¤å‹åˆ¥å®šç¾©åº«

## æˆæ¬Šèˆ‡æ²»ç†

* **æˆæ¬Š**ï¼šGPL Licenseï¼ˆè¦‹ LICENSE æª”æ¡ˆï¼‰
* **é–‹æºç­–ç•¥**ï¼š
  - å…¬é–‹é€æ˜çš„ã€Œä¸æ”¯æ´ç‰¹æ€§ã€èˆ‡ã€Œå·²çŸ¥èªç¾©å·®ç•°ã€æ¸…å–®
  - è©³ç´°çš„éŒ¯èª¤è¨Šæ¯èˆ‡å †ç–Šè¿½è¹¤
  - å®Œæ•´çš„æ–‡ä»¶èˆ‡ç¯„ä¾‹

## åƒè€ƒæ–‡ä»¶

- **CLAUDE.md**ï¼šClaude Code ä½¿ç”¨æŒ‡å—ï¼ŒåŒ…å«å¸¸ç”¨å‘½ä»¤èˆ‡æ¶æ§‹æ¦‚è¦½
- **docs/ARCHITECTURE.md**ï¼šè©³ç´°çš„æ¶æ§‹è¨­è¨ˆèˆ‡å¯¦ä½œç´°ç¯€
- **docs/CORE_CONCEPT.md**ï¼ˆæœ¬æ–‡ä»¶ï¼‰ï¼šæ ¸å¿ƒæ¦‚å¿µèˆ‡é–‹ç™¼è¨ˆç•«
- **README.md**ï¼šå°ˆæ¡ˆæ¦‚è¿°èˆ‡ä½¿ç”¨èªªæ˜
